{{ define "webhook.custom.payload" -}}
{
  "receiver": "{{ .Receiver }}",
  "status": "{{ .Status }}",
  "state": "{{ if eq .Status "resolved" }}ok{{ else }}alerting{{ end }}",
  "externalURL": "{{ .ExternalURL }}",
  "commonLabels": {{ toJson .CommonLabels }},
  "commonAnnotations": {{ toJson .CommonAnnotations }},
  "timestamp": "{{ now }}",
  "alerts": [
    {{- $first := true -}}
    {{- range .Alerts.Firing -}}
      {{- if not $first }},{{ end -}}
      {{- $first = false -}}
      {
        "agent": "SMH",
        "agent_location": "SaaS",
        "agent_time": "{{ now }}",
        "class": "SMH",
        "description": "{{ .Annotations.description }}: {{ .Annotations.summary }}",
        "external_id": "{{ .Fingerprint }}",
        "manager": "SMH",
        "severity": "{{ .Annotations.description }}",
        "status": "{{ .Status }}",
        "alertname": "{{ .Labels.alertname }}",
        "grafana_folder": "{{ .Labels.grafana_folder }}",
        "startsAt": "{{ .StartsAt }}",
        "generatorURL": "{{ .GeneratorURL }}",
        "silenceURL": "{{ .SilenceURL }}"
      }
    {{- end -}}
  ]
}
{{- end }}
